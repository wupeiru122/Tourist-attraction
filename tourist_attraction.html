<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link rel="stylesheet" href="./style.css">
    <title>Viewpoint</title>

    <style>
        
    </style>
</head>

<body>

    <section class="banner">
        <div class="bannerBorder">
            <h3 class="banner-title">台北市 - 遊憩景點</h3>
        </div>
    </section>

    <button id="btnPre">上一頁</button>
    <button id="btnNext">下一頁</button>

    <input id="searchText"><i class="fa-solid fa-magnifying-glass"></i>

    <button id="btnFavorite">加入我的最愛</button>

    <a href="./test02.html">查看我的最愛</a>

    <main class="viewpoint" id="viewpoint"></main>

    
    
 
    <script>
        let spotList;

        //分頁
        let page = 1;
        document.querySelector('#btnPre').addEventListener('click', ()=> {
            page--;
            if(page === 0){
                page = 1;
                return;
            }
            getSpotList();
        });
        document.querySelector('#btnNext').addEventListener('click', ()=> {
            page++;
            getSpotList();
        });

        const viewpoint = document.querySelector('#viewpoint');
        let fakePic = 'https://via.placeholder.com/400x200';

        getSpotList();
        function getSpotList(){
            const url = `https://www.travel.taipei/open-api/zh-tw/Attractions/All?page=${page}`;
            fetch(url, {
                headers: {
                    Accept: 'application/json'
                }
            })
            .then(resp => resp.json())
            .then(body => {
                spotList = body.data;
                showSpotList(spotList);
            });
        }

        function showSpotList(spots){
            viewpoint.innerHTML = '';

            for (let spot of spots) {
                viewpoint.insertAdjacentHTML('beforeend', `
                <section class="col"">
                    <figure class="viewpointCard">
                        <img src="${spot.images[0]?.src ?? fakePic}" class="picCard" alt="...">
                        <figcaption class="card-body">
                            <input type="checkbox" id='cb${spot.id}'>
                            <h3 class="card-title" style="display:inline-block;">${spot.name}</h3>
                            <h4 class="card-distric"><i class="fa-solid fa-location-dot"></i>${spot.distric}</h4>
                            <p class="card-text" style="overflow: hidden;text-overflow: ellipsis;display: -webkit-box;-webkit-line-clamp: 5;-webkit-box-orient: vertical;">
                                ${spot.introduction}
                            </p>
                        </figcaption>
                    </figure>
                </section>
                `);
            };
        }

    

        
            
    </script>
</body>

</html>